<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>äº”å€èˆŒè¨ºå°æ¸¬é©—</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: auto; padding: 20px; }
        .zone { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; }
        textarea { width: 100%; height: 60px; }
        img.preview { max-width: 300px; margin-top: 10px; display: none; }
    </style>
</head>
<body>
    <h1>äº”å€èˆŒè¨ºäº’å‹•å°æ¸¬é©—</h1>

    <form method="POST" enctype="multipart/form-data">
        <p>è«‹ç›´æ¥æ‹ç…§æˆ–ä¸Šå‚³èˆŒé ­åœ–ç‰‡ä¸¦å¡«å¯«ä½ å°äº”å€‹å€åŸŸçš„è§€å¯Ÿèˆ‡åˆ¤æ–·ï¼š</p>
        <input type="file" name="image" accept="image/*" capture="environment" onchange="previewImage(event)" required><br><br>

        <img id="preview" class="preview" src="#" alt="é è¦½åœ–ç‰‡">

        {% for zone in ["å¿ƒ", "è‚", "è„¾", "è‚º", "è…"] %}
            <div class="zone">
                <strong>{{ zone }} å€ï¼š</strong><br>
                <textarea name="{{ zone }}">{{ user_answers.get(zone, "") }}</textarea>
            </div>
        {% endfor %}

        <button type="submit">é€å‡ºåˆ†æèˆ‡å°ç…§</button>
    </form>

    {% if filename %}
        <hr>
        <h2>ğŸ–¼ï¸ èˆŒé ­å€åŸŸå°ç…§åœ–ï¼š</h2>
        <img src="{{ url_for('static', filename='tongue_map.png') }}" style="width: 300px;">
    {% endif %}

    {% if result %}
        <hr>
        <h2>ğŸ” åˆ†æçµæœèˆ‡æ¯”å°</h2>
        {% for zone in result %}
            <div class="zone">
                <strong>{{ zone }} å€</strong><br>
                ğŸ§  <u>ä½ è¼¸å…¥çš„è§€å¯Ÿï¼š</u> {{ user_answers[zone] }}<br>
                ğŸ§ª <u>ç³»çµ±è¨ºæ–·ï¼š</u> {{ result[zone]["è¨ºæ–·"] }}<br>
                âœ… <u>æ¯”å°çµæœï¼š</u> {{ compare[zone] }}<br>
                ğŸ“– ç†è«–ï¼š{{ result[zone]["ç†è«–"] }}<br>
                ğŸ’¡ å»ºè­°ï¼š{{ result[zone]["å»ºè­°"] }}
            </div>
        {% endfor %}
    {% endif %}

    <script>
        function previewImage(event) {
            const reader = new FileReader();
            reader.onload = function(){
                const output = document.getElementById('preview');
                output.src = reader.result;
                output.style.display = 'block';
            };
            reader.readAsDataURL(event.target.files[0]);
        }
    </script>
</body>
</html>
